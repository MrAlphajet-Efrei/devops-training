# Story 1.4: React/Next.js Frontend Service

## Status

**Draft**

---

## Story

**As a** DevOps engineer,
**I want** a simple React/Next.js frontend that calls the API,
**so that** I have a complete 3-tier application to deploy.

---

## Acceptance Criteria

1. Next.js application is created in `apps/frontend/`
2. Homepage displays data fetched from the API `/items` endpoint
3. Environment variable configures API URL (`NEXT_PUBLIC_API_URL`)
4. Application runs locally with `npm run dev` on port 3000
5. Basic styling is applied (minimal, portfolio-presentable)
6. `README.md` documents how to run the frontend locally

---

## Tasks / Subtasks

- [ ] **Task 1: Initialize Next.js Project** (AC: 1, 4)
  - [ ] Create `apps/frontend/` directory
  - [ ] Initialize Next.js 15 with TypeScript (`npx create-next-app@14`)
  - [ ] Enable App Router (default in Next.js 15)
  - [ ] Configure Tailwind CSS
  - [ ] Remove boilerplate/example content
  - [ ] Verify `npm run dev` starts on port 3000

- [ ] **Task 2: Set Up Project Structure** (AC: 1)
  - [ ] Create `src/components/` directory
  - [ ] Create `src/components/ui/` for generic components
  - [ ] Create `src/components/items/` for feature components
  - [ ] Create `src/components/layout/` for layout components
  - [ ] Create `src/hooks/` directory
  - [ ] Create `src/services/` directory
  - [ ] Create `src/types/` directory
  - [ ] Create `src/lib/` directory for utilities

- [ ] **Task 3: Configure Environment Variables** (AC: 3)
  - [ ] Create `.env.local.example` template
  - [ ] Add `NEXT_PUBLIC_API_URL` variable
  - [ ] Document environment variable in README
  - [ ] Add `.env.local` to `.gitignore`

- [ ] **Task 4: Create API Client Service** (AC: 2)
  - [ ] Create `src/services/api.ts` with base client
  - [ ] Implement `apiClient<T>()` generic function
  - [ ] Handle API errors gracefully
  - [ ] Create `src/services/items.ts` for items API
  - [ ] Implement `list()`, `create()`, `getById()` methods

- [ ] **Task 5: Create TypeScript Types** (AC: 2)
  - [ ] Create `src/types/item.ts`
  - [ ] Define `Item` interface
  - [ ] Define `CreateItemRequest` interface
  - [ ] Define `ItemListResponse` interface

- [ ] **Task 6: Create SWR Hook for Items** (AC: 2)
  - [ ] Install SWR dependency (`npm install swr`)
  - [ ] Create `src/hooks/useItems.ts`
  - [ ] Implement `useItems()` hook with SWR
  - [ ] Return items, isLoading, isError, refresh

- [ ] **Task 7: Create UI Components** (AC: 2, 5)
  - [ ] Create `src/components/ui/Card.tsx`
  - [ ] Create `src/components/items/ItemCard.tsx`
  - [ ] Create `src/components/items/ItemList.tsx`
  - [ ] Create `src/components/layout/Header.tsx`
  - [ ] Apply Tailwind CSS styling

- [ ] **Task 8: Build Homepage** (AC: 2, 5)
  - [ ] Update `src/app/page.tsx`
  - [ ] Add Header component
  - [ ] Add ItemList component
  - [ ] Display loading state
  - [ ] Display error state
  - [ ] Style for portfolio presentation

- [ ] **Task 9: Create Frontend README** (AC: 6)
  - [ ] Document project overview
  - [ ] Document prerequisites (Node.js 18+, npm)
  - [ ] Document installation steps
  - [ ] Document environment variables
  - [ ] Document how to run locally
  - [ ] Document available scripts

---

## Dev Notes

### Relevant Source Tree

```
apps/frontend/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── layout.tsx          # Root layout
│   │   ├── page.tsx            # Homepage
│   │   ├── loading.tsx         # Loading state
│   │   └── error.tsx           # Error boundary
│   ├── components/
│   │   ├── ui/                 # Generic UI components
│   │   │   └── Card.tsx
│   │   ├── items/              # Feature components
│   │   │   ├── ItemCard.tsx
│   │   │   └── ItemList.tsx
│   │   └── layout/             # Layout components
│   │       └── Header.tsx
│   ├── hooks/                  # Custom React hooks
│   │   └── useItems.ts
│   ├── services/               # API client layer
│   │   ├── api.ts
│   │   └── items.ts
│   ├── types/                  # TypeScript types
│   │   └── item.ts
│   └── lib/                    # Utilities
├── public/
├── .env.local.example
├── package.json
├── tailwind.config.ts
├── tsconfig.json
└── README.md
```

### API Client Pattern

```typescript
// src/services/api.ts
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || "http://localhost:8000";

export async function apiClient<T>(
  endpoint: string,
  options: RequestInit = {},
): Promise<T> {
  const response = await fetch(`${API_BASE_URL}${endpoint}`, {
    headers: {
      "Content-Type": "application/json",
      ...options.headers,
    },
    ...options,
  });

  if (!response.ok) {
    throw new Error(`API error: ${response.status}`);
  }

  return response.json();
}
```

### Items Service Pattern

```typescript
// src/services/items.ts
import { apiClient } from "./api";
import type { Item, ItemListResponse, CreateItemRequest } from "@/types/item";

export const itemsService = {
  list: () => apiClient<ItemListResponse>("/items"),
  getById: (id: string) => apiClient<Item>(`/items/${id}`),
  create: (data: CreateItemRequest) =>
    apiClient<Item>("/items", {
      method: "POST",
      body: JSON.stringify(data),
    }),
};
```

### SWR Hook Pattern

```typescript
// src/hooks/useItems.ts
import useSWR from "swr";
import { itemsService } from "@/services/items";

export function useItems() {
  const { data, error, isLoading, mutate } = useSWR("/items", () =>
    itemsService.list(),
  );

  return {
    items: data?.items ?? [],
    total: data?.total ?? 0,
    isLoading,
    isError: !!error,
    refresh: mutate,
  };
}
```

### TypeScript Types

```typescript
// src/types/item.ts
export interface Item {
  id: string;
  name: string;
  description?: string;
  createdAt: string;
  updatedAt: string;
}

export interface CreateItemRequest {
  name: string;
  description?: string;
}

export interface ItemListResponse {
  items: Item[];
  total: number;
}
```

### Tech Stack for This Story

| Technology   | Version | Purpose               |
| ------------ | ------- | --------------------- |
| Next.js      | 14.x    | React framework       |
| TypeScript   | 5.x     | Type safety           |
| Tailwind CSS | 3.x     | Styling               |
| SWR          | 2.x     | Data fetching/caching |
| React        | 18.x    | UI library            |

### Environment Variables

| Variable              | Example                 | Description     |
| --------------------- | ----------------------- | --------------- |
| `NEXT_PUBLIC_API_URL` | `http://localhost:8000` | Backend API URL |

### Naming Conventions

| Element    | Convention                  | Example            |
| ---------- | --------------------------- | ------------------ |
| Components | PascalCase                  | `ItemCard.tsx`     |
| Hooks      | camelCase with `use` prefix | `useItems.ts`      |
| Services   | camelCase                   | `itemsService`     |
| Types      | PascalCase                  | `ItemListResponse` |

### Dependencies on Previous Stories

- **Story 1.1**: Project structure must exist
- **Story 1.3**: API endpoints for `/items` must be available

### Key Constraints

- **Type Safety**: TypeScript strict mode
- **API Calls**: Use service layer, never direct fetch in components
- **Environment Variables**: Access through `process.env` only
- **Styling**: Tailwind CSS utility classes

### Important Implementation Notes

1. API URL defaults to localhost:8000 for development
2. SWR handles caching and revalidation automatically
3. Keep components simple - this is a portfolio demo
4. Error boundaries catch and display errors gracefully
5. Loading states improve user experience

---

## Testing

### Testing Requirements

| Test Type   | Coverage Target   | Framework                        |
| ----------- | ----------------- | -------------------------------- |
| Unit Tests  | Components render | Jest + React Testing Library     |
| Integration | API calls work    | Jest + MSW (mock service worker) |

### Test Scenarios

1. **test_item_card_renders_name** - ItemCard displays item name
2. **test_item_list_shows_loading** - ItemList shows loading state
3. **test_item_list_shows_items** - ItemList renders items from API
4. **test_item_list_shows_error** - ItemList handles API errors

### Test Commands

```bash
cd apps/frontend

# Run tests
npm test

# Run tests in watch mode
npm test -- --watch

# Run with coverage
npm test -- --coverage
```

---

## Change Log

| Date       | Version | Description         | Author |
| ---------- | ------- | ------------------- | ------ |
| 2025-01-26 | 1.0     | Initial story draft | SM Bob |

---

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

---

## QA Results

_To be filled by QA Agent_
